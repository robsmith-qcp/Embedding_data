import presses
import pyscf
import sys
import time

keywords = {}
keywords['scf_method'] = 'dft' # If dft is chosen, the user should specify the desired exchange-correlation functional
keywords['subsystem_method'] = 'mp2'
keywords['xc'] = 'pbe'
keywords['split_spade'] = False
keywords['atom'] = '''
C       -0.0005140249      0.0000189274      5.4786488248                 
O        0.0000000000      0.0000000000      4.3516551661                 
Fe       0.0000000000      0.0000000000      0.0000000000                 
N        0.2936944988      1.9903142998      0.1434832723                 
N        1.9922200588     -0.2870510862      0.1446325381                 
N       -0.2925683010     -1.9893329859      0.1397187911                 
N       -1.9907590493      0.2875761114      0.1413694721                 
N        0.0049025560      0.0038646327     -1.9638937903                 
C        1.4953844560      2.6558404818      0.1896456803                 
C       -0.6716727192      2.9676466000      0.1416696016                 
C        2.9729426148      0.6748423263      0.1925276444                 
C        2.6535024000     -1.4910836383      0.1438784444                 
C        0.6726047960     -2.9666329052      0.1375323032                 
C       -1.4938732280     -2.6544949647      0.1828571060                 
C       -2.6521672251      1.4914273128      0.1397232996                 
C       -2.9709307602     -0.6741826160      0.1858750607                 
C        0.8884954670      0.6134149152     -2.7315749224                 
C       -0.8968611018     -0.6178640011     -2.8027407319                 
C        2.7455618893      2.0468206054      0.2037235173                 
C       -2.0420634465      2.7393498127      0.1234026512                 
C       -2.7437108457     -2.0457543607      0.1973793831                 
C        2.0428393731     -2.7388890362      0.1234986360                 
C        1.2818569252      4.0848940844      0.2170006507                 
H        2.0694837097      4.8269837633      0.2637374340                 
C       -0.0646326461      4.2781274993      0.1852966835                 
H       -0.6130090862      5.2119053130      0.2008380647                 
C        4.0825101100     -1.2832751129      0.1904837162                 
H        4.8215063207     -2.0749475918      0.2077355794                 
C        4.2813426450      0.0624864073      0.2225572845                 
H        5.2171878199      0.6058507808      0.2710721928                 
C        0.0653440196     -4.2774634199      0.1773047960                 
H        0.6135799076     -5.2113489448      0.1906632183                 
C       -1.2808339057     -4.0838291672      0.2076014917                 
H       -2.0689655820     -4.8254230701      0.2496647045                 
C       -4.2798526394     -0.0623090400      0.2127445860                 
H       -5.2153620273     -0.6063152077      0.2561295436                 
C       -4.0817121565      1.2832095183      0.1820172622                 
H       -4.8208514459      2.0747721043      0.1963652005                 
H        3.6161748359      2.6962341577      0.2418630664                 
H       -2.6914207187      3.6105906521      0.1243989858                 
H       -3.6143623046     -2.6950284721      0.2315399660                 
H        2.6919528122     -3.6103994631      0.1249018572                 
N        0.5904872320      0.4083810699     -4.0385204891                 
C       -0.5450045565     -0.3746311665     -4.1021158970                 
H        1.7284599348      1.1930576886     -2.3808201960                 
H        1.1133705549      0.7690599543     -4.8226403032                 
H       -0.9844423687     -0.6772403270     -5.0396723834                 
H       -1.7227296605     -1.1882599035     -2.4081742251                 
'''
keywords['active_space_atoms'] = 3
keywords['basis'] = 'def2-svp'
keywords['spin'] = 0 # in PySCF this is the number of unpaired electrons, not 2s+1
keywords['charge'] = 0
keywords['conv_tol_grad'] = 1e-6
keywords['output_name'] = 'reactant'
keywords['spectrum'] = True
keywords["orthog"] = False

start = time.time()
e, mf, ec = presses.run_embed(keywords)
finish = time.time()-start
print('time elapsed: ', finish)
